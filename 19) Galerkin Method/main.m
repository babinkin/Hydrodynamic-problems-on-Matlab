clc;clear;global A1 A2 A3 A4 B1 B2 B3 B4 Re M N h;M = 81;N = 41;h = 0.075;epsilon = 1e-6;Re = 0;dRe = 5;iter = 0;psi = zeros(M, N);A_array = zeros(4, 1000);B_array = zeros(4, 1000);Re_array = zeros(1000);X = zeros(M, 1);X(1) = -3;for i = 2 : M        X(i) = X(i - 1) + h;    endY = zeros(N, 1);Y(1) = 0;for j = 2 : M        Y(j) = Y(j - 1) + h;    endfor i = 1 : 20    	A1 = - 44.689656 / 9.931035;	B1 = 0;	r_s = 2;    if (i >= 3 && i <= 11)                 dRe = 10;            end        if (i > 11)                dRe = 100;            end        Re = Re + dRe;        [A1, B1] = NewtonRaphson_modificied(A1, B1, epsilon);    A2 = -15 / 29 * (8 + 5 * A1);    A3 = 9 / 29 * (17 + 7 * A1);    A4 = - 1 / 58 * (95 + 34 * A1);    B2 = - 23 / 9 * B1;    B3 = 19 / 9 * B1;    B4 = - 5 / 9 * B1;    [r_s] = NewtonRaphson(r_s, epsilon);    if (i == 2 || i == 11 || i == 13)                iter = iter + 1;        A_array(1, iter) = A1;        A_array(2, iter) = A2;        A_array(3, iter) = A3;        A_array(4, iter) = A4;        B_array(1, iter) = B1;        B_array(2, iter) = B2;        B_array(3, iter) = B3;        B_array(4, iter) = B4;        Re_array(iter) = Re;            endendfor t = 1 : iter    A1 = A_array(1, t);    A2 = A_array(2, t);    A3 = A_array(3, t);    A4 = A_array(4, t);    B1 = B_array(1, t);    B2 = B_array(2, t);    B3 = B_array(3, t);    B4 = B_array(4, t);    Re = Re_array(t);        for i = 1 : M                for j = 1 : N                        [psi(i, j)] = psi_right(X(i), Y(j));                    end            end    const = [3.125; 2; 1.125; 0.5; 0.125; 0; -0.006];    hold on;    for i = 1 : length(const)                [x, y, z] = SEARCH(X, Y, psi, const(i));        plot(x(1 : z), y(1 : z), '.')            end    hold off;    title([['Flow about a sphere at Re = ' num2str(Re)] '.'])    xlabel('x')    ylabel('y')        if t == 1            legend(['PSI = ' num2str(const(1))],['PSI = ' num2str(const(2))],['PSI = ' num2str(const(3))],['PSI = ' num2str(const(4))],['PSI = ' num2str(const(5))],['PSI = ' num2str(const(6))])        end        if t > 1                  legend(['PSI = ' num2str(const(1))],['PSI = ' num2str(const(2))],['PSI = ' num2str(const(3))],['PSI = ' num2str(const(4))],['PSI = ' num2str(const(5))],['PSI = ' num2str(const(6))],['PSI = ' num2str(const(7))])        end        if (t < iter)                figure;            end    end